<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vin A.I</title>
<style>
body{margin:0;font-family:Arial,sans-serif;display:flex;flex-direction:column;height:100vh;background:#000;color:#fff;}
header{padding:12px;text-align:center;font-weight:bold;border-bottom:1px solid #333;display:flex;align-items:center;justify-content:center;gap:10px;position:relative;}
#chat{flex:1;overflow-y:auto;padding:16px;}
.message{margin:12px 0;max-width:70%;}
.user{margin-left:auto;text-align:right;}
.ai{margin-right:auto;text-align:left;}
.bubble{padding:10px;border-radius:8px;display:inline-block;background:#111;white-space:pre-wrap;border:1px solid #fff;}
.typing-bubble{opacity:0.7;font-style:italic;}

/* Code block */
.code-container {
  position: relative;
  background:#111;
  border:1px solid #fff;
  border-radius:8px;
  padding:10px;
  margin-top:8px;
  overflow:auto;
  font-family:monospace;
  white-space:pre;
}
.copy-btn {
  position: absolute;
  top:5px;
  right:5px;
  background:#000;
  border:1px solid #fff;
  color:#fff;
  padding:3px 6px;
  font-size:12px;
  border-radius:4px;
  cursor:pointer;
}
.copy-btn:hover{background:#222;}

/* Input */
.input-container{border-top:1px solid #333;padding:10px;display:flex;flex-direction:column;}
.input-row{display:flex;width:100%;gap:5px;align-items:center;}
#messageInput{flex:1;padding:10px;background:#111;border:1px solid #333;border-radius:8px;color:#fff;outline:none;}
button{background:#111;border:1px solid #fff;color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;padding:6px 10px;border-radius:6px;transition:all 0.2s;}
button:hover{background:#222;border-color:#fff;}
button svg{width:20px;height:20px;fill:#fff;}

/* Settings Panel */
#settingsOverlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);display:none;align-items:center;justify-content:center;z-index:100;}
#settingsPanel{background:#111;border:1px solid #fff;padding:20px;border-radius:12px;display:flex;flex-direction:column;gap:15px;min-width:220px;}
#settingsPanel h3{margin:0;text-align:center;border-bottom:1px solid #fff;padding-bottom:5px;}
.closeSettings{align-self:flex-end;background:none;border:none;color:#fff;font-weight:bold;font-size:16px;cursor:pointer;transition:all 0.2s;}
.closeSettings:hover{color:#aaa;}
.modeOptions{display:flex;gap:10px;justify-content:center;}
.modeOption{
  width:60px;height:60px;background:#000;color:#fff;border:2px solid #fff;display:flex;
  align-items:center;justify-content:center;border-radius:4px;cursor:pointer;font-size:12px;transition:all 0.2s;text-align:center;user-select:none;
}
.modeOption.selected{background:#fff;color:#000;}
.modeOption:hover{border-color:#aaa;}
</style>
</head>
<body>
<header>
  Vin A.I
  <button id="settingsBtn" title="Settings">
    <svg viewBox="0 0 24 24"><path d="M12 8a4 4 0 1 1 0 8 4 4 0 0 1 0-8m0-5a1 1 0 0 1 1 1v1.09a6.003 6.003 0 0 1 2.72 1.17l.77-.77a1 1 0 0 1 1.41 1.41l-.77.77a6.003 6.003 0 0 1 1.17 2.72H21a1 1 0 1 1 0 2h-1.09a6.003 6.003 0 0 1-1.17 2.72l.77.77a1 1 0 0 1-1.41 1.41l-.77-.77A6.003 6.003 0 0 1 13 19.91V21a1 1 0 0 1-2 0v-1.09a6.003 6.003 0 0 1-2.72-1.17l-.77.77a1 1 0 1 1-1.41-1.41l.77-.77A6.003 6.003 0 0 1 5.09 13H4a1 1 0 1 1 0-2h1.09a6.003 6.003 0 0 1 1.17-2.72l-.77-.77a1 1 0 0 1 1.41-1.41l.77.77A6.003 6.003 0 0 1 11 6.09V5a1 1 0 0 1 1-1z"/></svg>
  </button>
  <button id="clearBtn" title="Clear Chat" style="margin-left:10px;">
    <svg viewBox="0 0 24 24"><path d="M3 6h18v2H3V6zm2 3h14l-1.5 12.5a1 1 0 0 1-1 .5H8a1 1 0 0 1-1-.5L5 9zm3 2v8h2v-8H8zm4 0v8h2v-8h-2z"/></svg>
  </button>
</header>

<div id="settingsOverlay">
  <div id="settingsPanel">
    <button class="closeSettings">&times;</button>
    <h3>AI Mode</h3>
    <div class="modeOptions">
      <div class="modeOption" data-mode="human">Human</div>
      <div class="modeOption" data-mode="bro">Bro</div>
    </div>
  </div>
</div>

<div id="chat"></div>

<div class="input-container">
  <div class="input-row">
    <input type="text" id="messageInput" placeholder="Type a message...">
    <button id="sendBtn">
      <svg viewBox="0 0 24 24"><path d="M2 21l21-9L2 3v7l15 2-15 2v7z"/></svg>
    </button>
  </div>
</div>

<script>
const OPENAI_API_KEY = "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";

const chat = document.getElementById("chat");
const messageInput = document.getElementById("messageInput");
const sendBtn = document.getElementById("sendBtn");
const settingsBtn = document.getElementById("settingsBtn");
const clearBtn = document.getElementById("clearBtn");
const settingsOverlay = document.getElementById("settingsOverlay");
const closeSettings = document.querySelector(".closeSettings");
const modeSquares = document.querySelectorAll(".modeOption");

let aiMode = localStorage.getItem("vinAIMode") || "human";

function updateModeUI(){
  modeSquares.forEach(sq=>{
    if(sq.dataset.mode === aiMode) sq.classList.add("selected");
    else sq.classList.remove("selected");
  });
}
updateModeUI();
modeSquares.forEach(sq=>{
  sq.onclick = ()=>{
    aiMode = sq.dataset.mode;
    localStorage.setItem("vinAIMode", aiMode);
    updateModeUI();
    settingsOverlay.style.display = "none";
  }
});

settingsBtn.onclick = () => settingsOverlay.style.display = "flex";
closeSettings.onclick = () => settingsOverlay.style.display = "none";
settingsOverlay.onclick = e => { if(e.target === settingsOverlay) settingsOverlay.style.display = "none"; }

clearBtn.onclick = () => {
  if(confirm("Are you sure you want to clear all messages?")){
    localStorage.removeItem("vinAIChat");
    chat.innerHTML = "";
    messages = [
      {role: "system", content: aiMode === "bro" ? 
        "You are Vin A.I, friendly and casual. Speak like a bro, be human and informal." :
        "You are Vin A.I, helpful and professional. Always reply concisely and directly like a human."}
    ];
  }
};

let messages = [
  {role: "system", content: aiMode === "bro" ? 
    "You are Vin A.I, friendly and casual. Speak like a bro, be human and informal." :
    "You are Vin A.I, helpful and professional. Always reply concisely and directly like a human."}
];

let typingBubble = null;

const stored = localStorage.getItem("vinAIChat");
if(stored){
  const prev = JSON.parse(stored);
  prev.forEach(m => addMessage(m.content, m.role));
  messages.push(...prev);
}

function addMessage(text, sender, typing=false){
  const msg = document.createElement("div");
  msg.className = "message "+sender;

  if(text.includes("```")){
    const parts = text.split(/```/);
    parts.forEach((part,i)=>{
      if(i%2===0){
        if(part.trim()!==""){
          const bubble = document.createElement("div");
          bubble.className="bubble";
          if(typing) bubble.classList.add("typing-bubble");
          bubble.textContent = part;
          msg.appendChild(bubble);
        }
      } else {
        const codeContainer = document.createElement("div");
        codeContainer.className="code-container";
        codeContainer.textContent = part;
        const copyBtn = document.createElement("button");
        copyBtn.className="copy-btn";
        copyBtn.textContent="Copy";
        copyBtn.onclick = ()=>navigator.clipboard.writeText(part);
        codeContainer.appendChild(copyBtn);
        msg.appendChild(codeContainer);
      }
    });
  } else {
    const bubble = document.createElement("div");
    bubble.className="bubble";
    if(typing) bubble.classList.add("typing-bubble");
    bubble.textContent = text;
    msg.appendChild(bubble);
  }

  chat.appendChild(msg);
  chat.scrollTop = chat.scrollHeight;
  return msg;
}

async function sendMessage(){
  const text = messageInput.value.trim();
  if(!text) return;
  addMessage(text,"user");
  messages.push({role:"user",content:text});
  localStorage.setItem("vinAIChat", JSON.stringify(messages));
  messageInput.value="";

  typingBubble = addMessage("Vin A.I is typing...","ai",true);

  messages[0].content = aiMode === "bro" ? 
    "You are Vin A.I, friendly and casual. Speak like a bro, be human and informal." :
    "You are Vin A.I, helpful and professional. Always reply concisely and directly like a human.";

  try{
    const res = await fetch("https://api.openai.com/v1/chat/completions",{
      method:"POST",
      headers:{
        "Content-Type":"application/json",
        "Authorization":"Bearer "+OPENAI_API_KEY
      },
      body: JSON.stringify({
        model:"gpt-4o-mini",
        messages:[...messages,{role:"user",content:text}]
      })
    });

    const data = await res.json();
    const reply = data.choices?.[0]?.message?.content || "⚠️ No reply";

    typingBubble.remove();
    addMessage(reply,"ai");
    messages.push({role:"assistant", content:reply});
    localStorage.setItem("vinAIChat", JSON.stringify(messages));
  } catch(err){
    typingBubble.remove();
    addMessage("⚠️ Error connecting to API","ai");
  }
}

sendBtn.onclick = sendMessage;
messageInput.addEventListener("keypress", e=>{if(e.key==="Enter") sendMessage();});
</script>
</body>
</html>